# Vulnerability Report Generator

A comprehensive, interactive HTML vulnerability report generator that transforms JSON vulnerability data into professional, user-friendly security reports with charts, filtering, and modern styling.

## Features

### 📊 **Interactive Dashboard**
- Executive summary with key metrics
- Real-time vulnerability statistics
- Color-coded severity indicators
- Package risk scoring

### 📈 **Advanced Analytics**
- **Severity Distribution**: Donut chart showing vulnerability breakdown
- **Timeline Analysis**: Line chart of vulnerability publication dates
- **CVSS Score Distribution**: Bar chart of score ranges
- **Package Risk Assessment**: Horizontal bar chart of highest-risk packages

### 🔍 **Powerful Filtering**
- Real-time search across CVE IDs, packages, and descriptions
- Severity level filtering (Critical/High/Medium/Low)
- CVSS score range sliders
- Advanced sorting options
- Filter statistics and clear functionality

### 🎨 **Modern UI/UX**
- Responsive design (mobile/desktop)
- Dark/light theme toggle
- TailwindCSS styling with custom enhancements
- Smooth animations and transitions
- Print-friendly layout

### 📤 **Export Capabilities**
- PDF export (via browser print)
- CSV export of filtered results
- Self-contained HTML reports

## Installation

### Prerequisites
```bash
pip install jinja2
```

### Setup
```bash
# Clone or copy the vulnerability-reports directory
cd vulnerability-reports

# Make the script executable (optional)
chmod +x generate_report.py
```

## Usage

### Basic Usage
```bash
python generate_report.py \
  --input ../realistic_vulnerabilities.json \
  --output reports/vulnerability_report.html \
  --title "System Vulnerability Assessment Report"
```

### Command Line Options
```bash
python generate_report.py [OPTIONS]

Options:
  -i, --input PATH        Input JSON file (required)
  -o, --output PATH       Output HTML file (required)
  -t, --title TEXT        Report title (default: "Vulnerability Report")
  --theme [light|dark]    Report theme (default: "light")
  --template-dir PATH     Template directory (default: "templates")
```

### Example Commands
```bash
# Generate a basic report
python generate_report.py -i ../comprehensive_vulnerabilities.json -o reports/security_report.html

# Generate with custom title and dark theme
python generate_report.py \
  -i ../scan_results.json \
  -o reports/monthly_security_audit.html \
  -t "Monthly Security Audit - December 2024" \
  --theme dark

# Use custom template directory
python generate_report.py \
  -i ../vulnerabilities.json \
  -o reports/custom_report.html \
  --template-dir custom_templates/
```

## Input Data Format

The generator expects JSON data in the following format:

```json
{
  "total_vulnerabilities": 36,
  "packages_affected": 8,
  "vulnerability_breakdown": {
    "CRITICAL": 3,
    "HIGH": 8,
    "MEDIUM": 20,
    "LOW": 5,
    "unknown": 0
  },
  "high_risk_packages": [
    {
      "package": "git",
      "total_vulns": 10,
      "critical": 3,
      "high": 1,
      "medium": 4,
      "low": 2,
      "risk_score": 45
    }
  ],
  "vulnerabilities": [
    {
      "cve_id": "CVE-2022-4203",
      "definition_id": "oval:org.debian:def:...",
      "title": "CVE-2022-4203 openssl",
      "description": "Vulnerability description...",
      "affected_package": "openssl",
      "installed_version": "3.0.16-1~deb12u1",
      "cvss_score": 4.9,
      "severity": "MEDIUM",
      "summary": "Detailed summary...",
      "published_date": "2023-02-24 15:15:11.98+00:00"
    }
  ]
}
```

## File Structure

```
vulnerability-reports/
├── generate_report.py          # Main report generator script
├── templates/
│   └── vulnerability_report_template.html  # Jinja2 HTML template
├── static/
│   ├── css/
│   │   └── custom.css         # Custom styling
│   └── js/
│       └── report.js          # Interactive functionality
├── reports/                   # Generated reports directory
└── README.md                  # This file
```

## Customization

### Styling
- Edit `static/css/custom.css` for custom styles
- Modify TailwindCSS classes in the template
- Add custom animations and themes

### Template
- Modify `templates/vulnerability_report_template.html`
- Add new sections or charts
- Customize layout and structure

### JavaScript
- Edit `static/js/report.js` for new interactive features
- Add custom filtering logic
- Implement additional chart types

## Integration with Vulnerability Scanners

### With comprehensive_vulnerability_checker.py
```bash
# Run vulnerability scan
python ../comprehensive_vulnerability_checker.py \
  --vuls-result ../results/scan_result.json \
  --output ../comprehensive_vulnerabilities.json

# Generate report
python generate_report.py \
  -i ../comprehensive_vulnerabilities.json \
  -o reports/security_assessment.html \
  -t "Infrastructure Security Assessment"
```

### Automation Example
```bash
#!/bin/bash
# automated_security_report.sh

DATE=$(date +%Y%m%d)
SCAN_FILE="../results/scan_${DATE}.json"
VULN_FILE="../vulnerabilities_${DATE}.json"
REPORT_FILE="reports/security_report_${DATE}.html"

# Run vulnerability scan
python ../comprehensive_vulnerability_checker.py \
  --vuls-result "$SCAN_FILE" \
  --output "$VULN_FILE"

# Generate HTML report
python generate_report.py \
  -i "$VULN_FILE" \
  -o "$REPORT_FILE" \
  -t "Security Assessment - $(date +%B\ %Y)"

echo "Report generated: $REPORT_FILE"
```

## Browser Compatibility

- **Modern Browsers**: Chrome 90+, Firefox 88+, Safari 14+, Edge 90+
- **Features**: ES6+, CSS Grid, Flexbox, Chart.js
- **Mobile**: Responsive design works on all screen sizes

## Performance

- **Large Datasets**: Optimized for 1000+ vulnerabilities
- **Lazy Loading**: Vulnerability details loaded on demand
- **Debounced Search**: Smooth filtering experience
- **Virtual Scrolling**: Handles large lists efficiently

## Security Considerations

- **Self-Contained**: No external dependencies in generated reports
- **No Data Transmission**: All processing happens locally
- **Safe HTML**: Jinja2 auto-escaping prevents XSS
- **Print Security**: Sensitive data can be excluded from print view

## Troubleshooting

### Common Issues

1. **Template Not Found**
   ```bash
   # Ensure you're in the correct directory
   cd vulnerability-reports
   python generate_report.py ...
   ```

2. **JSON Parse Error**
   ```bash
   # Validate your JSON input
   python -m json.tool ../your_input.json
   ```

3. **Permission Denied**
   ```bash
   # Check file permissions
   chmod +x generate_report.py
   chmod 755 reports/
   ```

4. **Missing Dependencies**
   ```bash
   pip install jinja2
   ```

### Debug Mode
```bash
# Add debug output
python -v generate_report.py -i input.json -o output.html
```

## Contributing

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Test with sample data
5. Submit a pull request

## License

This project is open source. Feel free to modify and distribute according to your needs.

## Changelog

### v1.0.0 (2024-12-26)
- Initial release
- Interactive dashboard with charts
- Advanced filtering and search
- Dark/light theme support
- Export functionality
- Mobile-responsive design
- Print-friendly layout

---

**Generated by Vulnerability Report Generator**
For support and updates, please refer to the project documentation.
